from Crypto.Cipher import AES
from Crypto.Util.Padding import pad, unpad
from Crypto.Random import get_random_bytes
import os 

KEV = get_random_bytes(16)
IV = get_random_bytes(16)

def encrypt(plaintext):
    cipher = AES.new(KEY, AES.MODE_OFB, IV)
    ciphertext = cipher.encrypt(pad(plaintext, AES.block_size))
    return ciphertext

for file_name in os.listdir('.'):
    if file_name.endswith('.png'):
        with open(file_name, 'rb') as f:
            plaintext = f.read()
        ciphertext = encrypt(key, plaintext)
        with open(file_name + '.enc', 'wb') as f:
            f.write(ciphertext)
            
# ForestyHC{the_real_malware_never_use_OFB_1a42fa}